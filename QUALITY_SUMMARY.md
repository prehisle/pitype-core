# ğŸ¯ pitype-core è´¨é‡æå‡æ–¹æ¡ˆæ€»ç»“

## ğŸ“‹ å·²å®æ–½çš„æ”¹è¿›

### 1ï¸âƒ£ ä»£ç æäº¤è´¨é‡æ§åˆ¶

**æ–°å¢æ–‡ä»¶ï¼š**

- `.commitlintrc.json` - æäº¤æ¶ˆæ¯è§„èŒƒé…ç½®
- `.lintstagedrc.json` - æš‚å­˜æ–‡ä»¶æ£€æŸ¥é…ç½®
- `.husky/pre-commit` - æäº¤å‰é’©å­
- `.husky/commit-msg` - æäº¤æ¶ˆæ¯éªŒè¯é’©å­
- `.editorconfig` - ç¼–è¾‘å™¨é…ç½®ç»Ÿä¸€

**æ•ˆæœï¼š**

- âœ… å¼ºåˆ¶ä»£ç æ ¼å¼åŒ–ï¼ˆPrettierï¼‰
- âœ… è‡ªåŠ¨ä»£ç æ£€æŸ¥ï¼ˆESLintï¼‰
- âœ… å¢é‡æµ‹è¯•ï¼ˆä»…æµ‹è¯•ç›¸å…³æ–‡ä»¶ï¼‰
- âœ… è§„èŒƒæäº¤æ¶ˆæ¯ï¼ˆConventional Commitsï¼‰

---

### 2ï¸âƒ£ CI/CD è´¨é‡é—¨ç¦

**æ–°å¢æ–‡ä»¶ï¼š**

- `.github/workflows/quality-gate.yml` - å®Œæ•´è´¨é‡é—¨ç¦æµç¨‹

**åŒ…å«æ£€æŸ¥é¡¹ï¼š**

1. **ä»£ç è´¨é‡æ£€æŸ¥** (lint)
   - ESLint è§„èŒƒæ£€æŸ¥
   - Prettier æ ¼å¼æ£€æŸ¥

2. **å•å…ƒæµ‹è¯• & è¦†ç›–ç‡** (unit-test)
   - Vitest æµ‹è¯•è¿è¡Œ
   - è¦†ç›–ç‡é˜ˆå€¼éªŒè¯ï¼š80/70/80/80
   - Codecov æŠ¥å‘Šä¸Šä¼ 

3. **E2Eæµ‹è¯•** (e2e-test)
   - Playwright è·¨æµè§ˆå™¨æµ‹è¯•
   - HTML æµ‹è¯•æŠ¥å‘Š

4. **ç±»å‹æ£€æŸ¥** (type-check)
   - æ ¸å¿ƒåº“ç±»å‹éªŒè¯
   - æ‰€æœ‰ç¤ºä¾‹ç±»å‹éªŒè¯

5. **æ„å»ºéªŒè¯** (build)
   - æ ¸å¿ƒåº“æ„å»º
   - æ‰€æœ‰ç¤ºä¾‹æ„å»º
   - æ„å»ºäº§ç‰©éªŒè¯

6. **å®‰å…¨æ‰«æ** (security)
   - npm audit æ¼æ´æ‰«æ
   - Snyk æ·±åº¦åˆ†æ
   - CodeQL ä»£ç å®‰å…¨

7. **Bundleå¤§å°æ£€æŸ¥** (bundle-size)
   - é™åˆ¶ï¼š500KB
   - PR è‡ªåŠ¨è¯„è®º

8. **æäº¤æ¶ˆæ¯æ£€æŸ¥** (commit-lint)
   - PR æäº¤å†å²éªŒè¯

9. **è´¨é‡é—¨ç¦æ±‡æ€»** (quality-gate)
   - æ‰€æœ‰æ£€æŸ¥æ±‡æ€»
   - å¤±è´¥é˜»æ­¢åˆå¹¶

---

### 3ï¸âƒ£ è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

**æ–°å¢æ–‡ä»¶ï¼š**

- `.github/workflows/release.yml` - è‡ªåŠ¨å‘å¸ƒæµç¨‹
- `.releaserc.json` - Semantic Release é…ç½®

**åŠŸèƒ½ï¼š**

- âœ… è‡ªåŠ¨åˆ†ææäº¤ç±»å‹
- âœ… è‡ªåŠ¨ç¡®å®šç‰ˆæœ¬å·ï¼ˆmajor/minor/patchï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆ CHANGELOG.md
- âœ… è‡ªåŠ¨å‘å¸ƒåˆ° npm
- âœ… è‡ªåŠ¨åˆ›å»º GitHub Release
- âœ… è‡ªåŠ¨æ‰“ Git Tag

**ç‰ˆæœ¬è§„åˆ™ï¼š**

- `feat:` â†’ minor ç‰ˆæœ¬
- `fix:` / `perf:` â†’ patch ç‰ˆæœ¬
- `BREAKING CHANGE` â†’ major ç‰ˆæœ¬

---

### 4ï¸âƒ£ PRæµç¨‹è§„èŒƒåŒ–

**æ–°å¢æ–‡ä»¶ï¼š**

- `.github/pull_request_template.md` - PR æ¨¡æ¿
- `.github/CODEOWNERS` - ä»£ç æ‰€æœ‰è€…é…ç½®

**æ•ˆæœï¼š**

- âœ… æ ‡å‡†åŒ– PR æè¿°
- âœ… å¼ºåˆ¶è‡ªæ£€æ¸…å•
- âœ… è‡ªåŠ¨åˆ†é…å®¡æŸ¥äºº
- âœ… æ˜ç¡®å½±å“èŒƒå›´

---

### 5ï¸âƒ£ ä¾èµ–è‡ªåŠ¨ç®¡ç†

**æ–°å¢æ–‡ä»¶ï¼š**

- `.github/dependabot.yml` - ä¾èµ–è‡ªåŠ¨æ›´æ–°é…ç½®
- `.github/workflows/security-scan.yml` - å®šæœŸå®‰å…¨æ‰«æ

**åŠŸèƒ½ï¼š**

- âœ… æ¯å‘¨è‡ªåŠ¨æ£€æŸ¥ä¾èµ–æ›´æ–°
- âœ… è‡ªåŠ¨åˆ›å»ºæ›´æ–° PR
- âœ… åˆ†ç»„æ›´æ–°ï¼ˆå¼€å‘/æµ‹è¯•ä¾èµ–ï¼‰
- âœ… npm audit å®šæœŸæ‰«æ
- âœ… Snyk å®‰å…¨ç›‘æ§
- âœ… CodeQL ä»£ç åˆ†æ
- âœ… è®¸å¯è¯åˆè§„æ£€æŸ¥

---

### 6ï¸âƒ£ æ€§èƒ½ç›‘æ§

**æ–°å¢æ–‡ä»¶ï¼š**

- `.github/workflows/performance.yml` - æ€§èƒ½ç›‘æ§æµç¨‹
- `.lighthouserc.json` - Lighthouse CI é…ç½®

**ç›‘æ§é¡¹ï¼š**

- âœ… Bundle å¤§å°åˆ†æ
- âœ… size-limit é™åˆ¶
- âœ… Lighthouse æ€§èƒ½è¯„åˆ†
- âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•
- âœ… è‡ªåŠ¨æ€§èƒ½æŠ¥å‘Š

**æ€§èƒ½ç›®æ ‡ï¼š**

- Performance: â‰¥90
- Accessibility: â‰¥90
- Best Practices: â‰¥90
- SEO: â‰¥90

---

### 7ï¸âƒ£ å¼€å‘å·¥å…·é“¾å‡çº§

**package.json æ–°å¢è„šæœ¬ï¼š**

```json
{
  "test:coverage": "vitest --run --coverage",
  "lint:fix": "eslint . --ext .js,.ts,.mjs --fix",
  "format:check": "prettier --check ...",
  "type-check": "cd packages/pitype-core && tsc --noEmit",
  "prepare": "husky install",
  "release": "semantic-release",
  "validate": "npm run lint && npm run type-check && npm run test"
}
```

**æ–°å¢ä¾èµ–ï¼š**

- `@commitlint/*` - æäº¤æ¶ˆæ¯æ£€æŸ¥
- `husky` + `lint-staged` - Git hooks
- `semantic-release` - è‡ªåŠ¨å‘å¸ƒ
- `@size-limit/file` - Bundle å¤§å°é™åˆ¶
- å„ç§ semantic-release æ’ä»¶

---

## ğŸ“Š è´¨é‡é—¨ç¦å¯¹æ¯”

### æ”¹è¿›å‰

```
æäº¤ä»£ç 
  â†“
æ‰‹åŠ¨è¿è¡Œ npm test (å¯èƒ½å¿˜è®°)
  â†“
æ‰‹åŠ¨æ£€æŸ¥ lint (å¯èƒ½è·³è¿‡)
  â†“
ç›´æ¥æ¨é€åˆ°è¿œç¨‹
  â†“
CI: åªæœ‰åŸºç¡€çš„ lint + test
  â†“
æ‰‹åŠ¨å‘å¸ƒåˆ° npm
  â†“
æ‰‹åŠ¨ç¼–å†™ changelog
```

### æ”¹è¿›å

```
æäº¤ä»£ç 
  â†“
Pre-commit: è‡ªåŠ¨ lint + format + å¢é‡æµ‹è¯•
  â†“
Commit-msg: éªŒè¯æäº¤æ¶ˆæ¯æ ¼å¼
  â†“
æ¨é€åˆ°è¿œç¨‹
  â†“
CI è´¨é‡é—¨ç¦ (9ä¸ªå¹¶è¡Œæ£€æŸ¥):
  â”œâ”€ Code Lint
  â”œâ”€ Unit Tests (è¦†ç›–ç‡ â‰¥80%)
  â”œâ”€ E2E Tests
  â”œâ”€ Type Check
  â”œâ”€ Build
  â”œâ”€ Security Scan
  â”œâ”€ Bundle Size (â‰¤500KB)
  â”œâ”€ Commit Lint
  â””â”€ Performance Check
  â†“
æ‰€æœ‰æ£€æŸ¥é€šè¿‡ â†’ å…è®¸åˆå¹¶
  â†“
åˆå¹¶åˆ° main â†’ è‡ªåŠ¨è§¦å‘å‘å¸ƒ:
  â”œâ”€ åˆ†ææäº¤å†å²
  â”œâ”€ ç¡®å®šç‰ˆæœ¬å·
  â”œâ”€ ç”Ÿæˆ Changelog
  â”œâ”€ å‘å¸ƒåˆ° npm
  â”œâ”€ åˆ›å»º GitHub Release
  â””â”€ æ‰“ Git Tag
```

---

## ğŸ¯ è´¨é‡æŒ‡æ ‡æå‡

| æŒ‡æ ‡           | æ”¹è¿›å‰      | æ”¹è¿›å                    | æå‡       |
| -------------- | ----------- | ------------------------- | ---------- |
| **ä»£ç è§„èŒƒ**   | æ‰‹åŠ¨æ£€æŸ¥    | è‡ªåŠ¨å¼ºåˆ¶                  | â­â­â­â­â­ |
| **æµ‹è¯•è¦†ç›–ç‡** | 80/70/80/80 | 80/70/80/80 + å¼ºåˆ¶æ‰§è¡Œ    | â­â­â­â­   |
| **æäº¤è§„èŒƒ**   | æ— è§„èŒƒ      | Conventional Commits      | â­â­â­â­â­ |
| **å®‰å…¨æ‰«æ**   | æ—           | npm audit + Snyk + CodeQL | â­â­â­â­â­ |
| **æ€§èƒ½ç›‘æ§**   | æ—           | Lighthouse + Bundle åˆ†æ  | â­â­â­â­â­ |
| **å‘å¸ƒæµç¨‹**   | æ‰‹åŠ¨        | å…¨è‡ªåŠ¨                    | â­â­â­â­â­ |
| **CI æ—¶é—´**    | ~2åˆ†é’Ÿ      | ~5-8åˆ†é’Ÿ                  | â­â­â­     |
| **å‘å¸ƒå¯é æ€§** | ä¸­          | é«˜                        | â­â­â­â­â­ |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
npm run prepare  # åˆå§‹åŒ– husky
```

### 2. é…ç½® GitHub Secrets

åœ¨ä»“åº“è®¾ç½®ä¸­æ·»åŠ ï¼š

- `CODECOV_TOKEN` - Codecov ä»¤ç‰Œ (å¿…éœ€)
- `NPM_TOKEN` - npm å‘å¸ƒä»¤ç‰Œ (å¿…éœ€)
- `SNYK_TOKEN` - Snyk ä»¤ç‰Œ (æ¨è)

### 3. è®¾ç½®åˆ†æ”¯ä¿æŠ¤

åœ¨ GitHub è®¾ç½®ä¸­ä¸º `main` åˆ†æ”¯å¯ç”¨ï¼š

- Require PR before merging
- Require status checks to pass
- é€‰æ‹©æ‰€æœ‰è´¨é‡æ£€æŸ¥é¡¹

### 4. å¼€å§‹ä½¿ç”¨

```bash
# æ­£å¸¸å¼€å‘
git add .
git commit -m "feat: add new feature"  # ä¼šè‡ªåŠ¨è¿è¡Œæ£€æŸ¥
git push

# åˆ›å»º PR
# â†’ CI è‡ªåŠ¨è¿è¡Œæ‰€æœ‰è´¨é‡æ£€æŸ¥

# åˆå¹¶åˆ° main
# â†’ è‡ªåŠ¨å‘å¸ƒæ–°ç‰ˆæœ¬
```

---

## ğŸ“ˆ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸ (1-3ä¸ªæœˆ)

1. **æå‡æµ‹è¯•è¦†ç›–ç‡** â†’ ç›®æ ‡ 85%+
2. **ä¼˜åŒ– Bundle å¤§å°** â†’ ç›®æ ‡ <300KB
3. **å®Œå–„ API æ–‡æ¡£** â†’ ä½¿ç”¨ TypeDoc
4. **æ·»åŠ è§†è§‰å›å½’æµ‹è¯•** â†’ Percy/Chromatic

### ä¸­æœŸ (3-6ä¸ªæœˆ)

1. **SonarQube é›†æˆ** â†’ æ·±åº¦ä»£ç è´¨é‡åˆ†æ
2. **æ€§èƒ½ Dashboard** â†’ å¯è§†åŒ–æ€§èƒ½è¶‹åŠ¿
3. **å¤šç‰ˆæœ¬æ”¯æŒ** â†’ LTS ç‰ˆæœ¬ç®¡ç†
4. **å›½é™…åŒ–æµ‹è¯•** â†’ å¤šè¯­è¨€æ”¯æŒéªŒè¯

### é•¿æœŸ (6-12ä¸ªæœˆ)

1. **è´¡çŒ®è€…ç¤¾åŒº** â†’ å¼€æºåä½œè§„èŒƒ
2. **AI ä»£ç å®¡æŸ¥** â†’ æ™ºèƒ½ PR å®¡æŸ¥
3. **è´¨é‡ Dashboard** â†’ ç»Ÿä¸€è´¨é‡å¯è§†åŒ–
4. **è‡ªåŠ¨æ€§èƒ½ä¼˜åŒ–** â†’ åŸºäºç›‘æ§çš„è‡ªåŠ¨ä¼˜åŒ–

---

## ğŸ“– è¯¦ç»†æ–‡æ¡£

å®Œæ•´å®æ–½æŒ‡å—è¯·æŸ¥çœ‹ï¼š[QUALITY_IMPLEMENTATION_GUIDE.md](./QUALITY_IMPLEMENTATION_GUIDE.md)

---

## âœ… æ£€æŸ¥æ¸…å•

- [ ] é˜…è¯»å®Œæ•´çš„å®æ–½æŒ‡å—
- [ ] å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆ`npm install`ï¼‰
- [ ] åˆå§‹åŒ– huskyï¼ˆ`npm run prepare`ï¼‰
- [ ] é…ç½® GitHub Secrets
- [ ] è®¾ç½®åˆ†æ”¯ä¿æŠ¤è§„åˆ™
- [ ] åˆ›å»ºæµ‹è¯• PR éªŒè¯æµç¨‹
- [ ] å‘å›¢é˜ŸåŸ¹è®­æäº¤è§„èŒƒ
- [ ] ç›‘æ§è´¨é‡æŒ‡æ ‡

---

## ğŸ’¡ æ ¸å¿ƒä»·å€¼

1. **è´¨é‡å¯æ§** - æ‰€æœ‰ä»£ç éƒ½ç»è¿‡ä¸¥æ ¼éªŒè¯
2. **è‡ªåŠ¨åŒ–** - å‡å°‘äººå·¥æ“ä½œï¼Œæé«˜æ•ˆç‡
3. **å¯è¿½æº¯** - å®Œæ•´çš„æäº¤å†å²å’Œå˜æ›´è®°å½•
4. **å®‰å…¨æ€§** - æŒç»­çš„å®‰å…¨æ‰«æå’Œä¾èµ–æ›´æ–°
5. **æ€§èƒ½ä¿éšœ** - è‡ªåŠ¨åŒ–æ€§èƒ½ç›‘æ§
6. **åä½œæ•ˆç‡** - è§„èŒƒåŒ–çš„æµç¨‹å’Œæ¨¡æ¿

---

**ç”Ÿæˆæ—¶é—´**: 2025-11-16
**æ–¹æ¡ˆç‰ˆæœ¬**: v1.0
**ç»´æŠ¤è€…**: @stoa
